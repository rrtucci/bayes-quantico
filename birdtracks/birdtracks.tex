\chapter{Birdtracks: COMING SOON}
\label{ch-birdtracks}

\section{Classical Bayesian Networks and their Instantiations}

TPM (Transition Probability Matrix) $P(y|x)\in [0,1]$
where  $x\in val(\rvx)$ and $y\in val(\rvy)$

\beq
\sum_{y\in val(\rvy)}P(y|x) = 1
\eeq

\beq
\calc=
\bcen
\xymatrix{
&\rvb\ar[ld]
\\
\rvc
&&\rva\ar[ll]\ar[lu]
}
\ecen
\eeq

\beq
\calc(a,b,c)
=
P(c|b,a)P(b|a)P(a)
=
\bcen
\xymatrix{
&b\ar[ld]
\\
c
&&a\ar[ll]\ar[lu]
}
\ecen
P(a)
\eeq

$a^2 = (a_1, a_2)$
\beq
\calc'=
\bcen
\xymatrix{
&\rvb\ar[ld]
\\
\rvc
&&\rva^2\ar[ll]|{\rva_2}\ar[lu]|{\rva_1}
}
\ecen
\eeq

\beq
\calc'(a^2,b,c)
=
P(c|b,a_2)P(a_2|a^2)P(b|a_1)P(a_1|a^2)P(a^2)
=
\bcen
\xymatrix{
&b\ar[ld]
\\
c
&&a^2
\ar[ll]|{a_2}\ar[lu]|{a_1}
}
\ecen
P(a^2)
\eeq

Marginalizer nodes  $\rva_1$ and $\rva_2$
have the TPMs
\beq \color{blue}
P(a'_i|\rva^2=(a_1,a_2)) = \delta(a'_i, a_i)
\eeq
for $i=1,2$


\section{Quantum Bayesian Networks and
their Instantiations}

TPM (Transition Probability Matrix) 
$A(y|x)\in\CC$
where  $x\in val(\rvx)$ and $y\in val(\rvy)$

\beq
\sum_{y\in val(\rvy)}|A(y|x)|^2 = 1
\eeq

\beq
\calq=
\bcen
\xymatrix{
&\rvb\ar[ld]
\\
\rvc
&&\rva\ar[ll]\ar[lu]
}
\ecen
\eeq

\beq
\calq(a,b,c)
=
A(c|b,a)A(b|a)A(a)
=
\bcen
\xymatrix{
&b\ar[ld]
\\
c
&&a\ar[ll]\ar[lu]
}
\ecen
A(a)
\eeq

$a^2 = (a_1, a_2)$
\beq
\calq'=
\bcen
\xymatrix{
&\rvb\ar[ld]
\\
\rvc
&&\rva^2\ar[ll]|{\rva_2}\ar[lu]|{\rva_1}
}
\ecen
\eeq

\beq
\calq'(a^2,b,c)
=
A(c|b,a_2)A(a_2|a^2)A(b|a_1)A(a_1|a^2)A(a^2)
=
\bcen
\xymatrix{
&b\ar[ld]
\\
c
&&a^2
\ar[ll]|{a_2}\ar[lu]|{a_1}
}
\ecen
A(a^2)
\eeq

Marginalizer nodes  $\rva_1$ and $\rva_2$
have the TAMs
\beq \color{blue}
A(a'_i|\rva^2=(a_1,a_2)) = \delta(a'_i, a_i)
\eeq
for $i=1,2$

\section{Birdtracks}

\beq
\delta(b,a)=\indi(a=b)=
\delta^b_a =
\xymatrix{a&\ar[l]|\bullet b}
\eeq


\beq
\bra{a,b}
X_{\rva,\bullet,\rvb, \bullet}^{\bullet,\rvc,\bullet,\rvd}
\ket{c,d}
=
X_{a,\bullet,b, \bullet}^{\bullet,c,\bullet,d}
=
\bcen
\xymatrix@R=1pc{
a
&X_{\rva,\bullet,\rvb, \bullet}
^{\bullet,\rvc,\bullet,\rvd}
\ar[dl]\ar[l]
\\
b
\\
c\ar[ruu]
\\
d\ar[ruuu]
}\ecen
\eeq

\beq
\bcen
\xymatrix@R=1pc{
a
&X_{\rva,\bullet,\rvb, \bullet}
^{\bullet,\rvc,\bullet,\rvd}
\ar[dl]\ar[l]
\\
b
\\
c\ar[ruu]
\\
d\ar[ruuu]
}\ecen
\rarrow
\bcen
\xymatrix@R=1pc{
a,b
&X_{\rva,\bullet,\rvb, \bullet}
^{\bullet,\rvc,\bullet,\rvd}
\ar[dl]\ar[l]
\\
a,b
\\
c\ar[ruu]
\\
d\ar[ruuu]
}\ecen
\eeq
$X_{\rva,\bullet,\rvb, \bullet}
^{\bullet,\rvc,\bullet,\rvd}\in V^2 \otimes V_2$.
Sometimes, 
we will omit denote
this node simply b y $X$.
This if okay as long as
we are not using,
$X$ to also denote
a different version of $X^{\rva,\bullet,\rvb, \bullet}
_{\bullet,\rvc,\bullet,\rvd}$
with some of the indices
raised or lowered or 
their order has been changed.

\beq
(X^\dagger)^{a,\bullet,b, \bullet}_{\bullet,c,\bullet,d}
=
\bcen
\xymatrix@R=1pc{
a
&(X^\dagger)^{\rva,\bullet,\rvb, \bullet}
_{\bullet,\rvc,\bullet,\rvd}
\ar@{<-}[dl]
\ar@{<-}[l]
\\
b
\\
c\ar@{<-}[ruu]
\\
d\ar@{<-}[ruuu]
}\ecen
\eeq


\beqa
(X^\dagger)^{a,\bullet,b, \bullet}_{\bullet,c,\bullet,d}
X_{a,\bullet,b, \bullet}^{\bullet,c,\bullet,d}
&=&
\bcen
\xymatrix@R=1pc{
(X^\dagger)^{\rva,\bullet,\rvb, \bullet}_{\bullet,\rvc,\bullet,\rvd}
&\sum a\ar[l]\ar@{<-}[r]
&
X_{\rva,\bullet,\rvb, \bullet}^{\bullet,\rvc,\bullet,\rvd}
\\
&\sum b\ar[ul]\ar@{<-}[ur]
&
\\
&\sum c\ar@{<-}[luu]
\ar[ruu]
&
\\
&\sum d\ar@{<-}[luuu]
\ar[ruuu]
&
}
\ecen
\\
&=&
\bcen
\xymatrix@R=1pc{
X^\dagger
&\ar[l]\ar@{<-}[r]
&
X
\\
&\ar[ul]\ar@{<-}[ur]
&
\\
&\ar@{<-}[luu]
\ar[ruu]
&
\\
&\ar@{<-}[luuu]
\ar[ruuu]
&
}
\ecen
\eeqa

$a^m\in \ZZ_+^m$

\beq
R^{a_3^{m_3}, b_2^{n_2}}
_{b_3^{n_3}, a_2^{m_2}}
S^{a_2^{m_2}, b_1^{n_1}}
_{b_2^{n_2}, a_1^{m_1}} =
\bcen
\xymatrix{
b_3^{n_3}
&R\ar[l]\ar@{<-}[ld]
&\sum  b_2^{n_2}\ar[l]
&S\ar[l]\ar@{<-}[ld]
&b_1^{n_1}\ar[l]
\\
a_3^{m_3}
&
&\sum a_2^{m_2}\ar@{<-}[lu]
&
&a_1^{m_1}\ar@{<-}[lu]
}
\ecen
\eeq

\beq
\tr_\rvb X_{a,\bullet,\rvb, \bullet}^{\bullet,\rvb,\bullet,d}
=
\sum_b X_{a,\bullet,b, \bullet}^{\bullet,b,\bullet,d}
=
\bcen
\xymatrix@R=1pc{
a
&X_{\rva,\bullet,\rvb, \bullet}
^{\bullet,\rvc,\bullet,\rvd}
\ar[dl]\ar[l]
\\
\ar@[red]@{-}[d]
&
\\
\ar[ruu]
\\
d\ar[ruuu]
}\ecen
\eeq


\beq
\xymatrix{
&\ar[d]
&
&\ar@{<-}[d]\ar@[red]@{-}[ll]
&
\\
&R\ar[l]\ar@{<-}[ld]
&
&S\ar@{<-}[ld]
&\ar[l]
\\
&
&\ar@{<-}[lu]
&
&\ar@{<-}[lu]
}
\eeq